!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=5)}([function(t,e,r){(function(t,n){var i=/%[sdj%]/g;e.format=function(t){if(!m(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(o(arguments[r]));return e.join(" ")}r=1;for(var n=arguments,s=n.length,a=String(t).replace(i,function(t){if("%%"===t)return"%";if(r>=s)return t;switch(t){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(t){return"[Circular]"}default:return t}}),c=n[r];r<s;c=n[++r])y(c)||!b(c)?a+=" "+c:a+=" "+o(c);return a},e.deprecate=function(r,i){if(w(t.process))return function(){return e.deprecate(r,i).apply(this,arguments)};if(!0===n.noDeprecation)return r;var s=!1;return function(){if(!s){if(n.throwDeprecation)throw new Error(i);n.traceDeprecation?console.trace(i):console.error(i),s=!0}return r.apply(this,arguments)}};var s,a={};function o(t,r){var n={seen:[],stylize:u};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),f(r)?n.showHidden=r:r&&e._extend(n,r),w(n.showHidden)&&(n.showHidden=!1),w(n.depth)&&(n.depth=2),w(n.colors)&&(n.colors=!1),w(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=c),l(n,t,n.depth)}function c(t,e){var r=o.styles[e];return r?"["+o.colors[r][0]+"m"+t+"["+o.colors[r][1]+"m":t}function u(t,e){return t}function l(t,r,n){if(t.customInspect&&r&&x(r.inspect)&&r.inspect!==e.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(n,t);return m(i)||(i=l(t,i,n)),i}var s=function(t,e){if(w(e))return t.stylize("undefined","undefined");if(m(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}if(g(e))return t.stylize(""+e,"number");if(f(e))return t.stylize(""+e,"boolean");if(y(e))return t.stylize("null","null")}(t,r);if(s)return s;var a=Object.keys(r),o=function(t){var e={};return t.forEach(function(t,r){e[t]=!0}),e}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(r)),A(r)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return h(r);if(0===a.length){if(x(r)){var c=r.name?": "+r.name:"";return t.stylize("[Function"+c+"]","special")}if(v(r))return t.stylize(RegExp.prototype.toString.call(r),"regexp");if(S(r))return t.stylize(Date.prototype.toString.call(r),"date");if(A(r))return h(r)}var u,b="",E=!1,R=["{","}"];(d(r)&&(E=!0,R=["[","]"]),x(r))&&(b=" [Function"+(r.name?": "+r.name:"")+"]");return v(r)&&(b=" "+RegExp.prototype.toString.call(r)),S(r)&&(b=" "+Date.prototype.toUTCString.call(r)),A(r)&&(b=" "+h(r)),0!==a.length||E&&0!=r.length?n<0?v(r)?t.stylize(RegExp.prototype.toString.call(r),"regexp"):t.stylize("[Object]","special"):(t.seen.push(r),u=E?function(t,e,r,n,i){for(var s=[],a=0,o=e.length;a<o;++a)T(e,String(a))?s.push(p(t,e,r,n,String(a),!0)):s.push("");return i.forEach(function(i){i.match(/^\d+$/)||s.push(p(t,e,r,n,i,!0))}),s}(t,r,n,o,a):a.map(function(e){return p(t,r,n,o,e,E)}),t.seen.pop(),function(t,e,r){if(t.reduce(function(t,e){return 0,e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1];return r[0]+e+" "+t.join(", ")+" "+r[1]}(u,b,R)):R[0]+b+R[1]}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function p(t,e,r,n,i,s){var a,o,c;if((c=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?o=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(o=t.stylize("[Setter]","special")),T(n,i)||(a="["+i+"]"),o||(t.seen.indexOf(c.value)<0?(o=y(r)?l(t,c.value,null):l(t,c.value,r-1)).indexOf("\n")>-1&&(o=s?o.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+o.split("\n").map(function(t){return"   "+t}).join("\n")):o=t.stylize("[Circular]","special")),w(a)){if(s&&i.match(/^\d+$/))return o;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+o}function d(t){return Array.isArray(t)}function f(t){return"boolean"==typeof t}function y(t){return null===t}function g(t){return"number"==typeof t}function m(t){return"string"==typeof t}function w(t){return void 0===t}function v(t){return b(t)&&"[object RegExp]"===E(t)}function b(t){return"object"==typeof t&&null!==t}function S(t){return b(t)&&"[object Date]"===E(t)}function A(t){return b(t)&&("[object Error]"===E(t)||t instanceof Error)}function x(t){return"function"==typeof t}function E(t){return Object.prototype.toString.call(t)}function R(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(w(s)&&(s=n.env.NODE_DEBUG||""),t=t.toUpperCase(),!a[t])if(new RegExp("\\b"+t+"\\b","i").test(s)){var r=n.pid;a[t]=function(){var n=e.format.apply(e,arguments);console.error("%s %d: %s",t,r,n)}}else a[t]=function(){};return a[t]},e.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=d,e.isBoolean=f,e.isNull=y,e.isNullOrUndefined=function(t){return null==t},e.isNumber=g,e.isString=m,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=w,e.isRegExp=v,e.isObject=b,e.isDate=S,e.isError=A,e.isFunction=x,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=r(3);var N=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function T(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",function(){var t=new Date,e=[R(t.getHours()),R(t.getMinutes()),R(t.getSeconds())].join(":");return[t.getDate(),N[t.getMonth()],e].join(" ")}(),e.format.apply(e,arguments))},e.inherits=r(4),e._extend=function(t,e){if(!e||!b(e))return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t}}).call(this,r(1),r(2))},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e){var r,n,i=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function o(t){if(r===setTimeout)return setTimeout(t,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(t){r=s}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var c,u=[],l=!1,h=-1;function p(){l&&c&&(l=!1,c.length?u=c.concat(u):h=-1,u.length&&d())}function d(){if(!l){var t=o(p);l=!0;for(var e=u.length;e;){for(c=u,u=[];++h<e;)c&&c[h].run();h=-1,e=u.length}c=null,l=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function y(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];u.push(new f(t,e)),1!==u.length||l||o(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},function(t,e,r){"use strict";r.r(e);class n{static add(t,e){return t+e}static multiply(t,e){return t*e}static divide(t,e){return t/e}static subtract(t,e){return t-e}static min(t,e){return Math.min(t,e)}static max(t,e){return Math.max(t,e)}static square(t){return t*t}}var i={ND_SLICE_CHARACTER:":",ND_PRINT_PRECISION:5,ND_NUMBER_REGEX:new RegExp(/-?\d+\.?(\d+)?/g),NUMBER:"number"};class s{static compareManyTypes(t){return t.map(function(t){return void 0===t.type?Float64Array:t.type}).reduce(this.compareTypes)}static compareTypes(t,e){return s.TYPE_RANKINGS[t]>s.TYPE_RANKINGS[e]?t:e}}s.TYPE_MAP={uint8:Uint8ClampedArray,int8:Int8Array,uint16:Uint16Array,int16:Int16Array,uint32:Uint32Array,int32:Int32Array,float32:Float32Array,float64:Float64Array},s.TYPE_RANKINGS={uint8:0,int8:1,uint16:2,int16:3,uint32:4,int32:5,float32:6,float64:7,undefined:7};var a={math:class{static*getIntegerRange(t,e,r){for(;t<e;)yield t,t+=r}static isNumber(t){return!isNaN(parseFloat(t))&&isFinite(t)}},array:{header:class{static getStride(t,e=1){return t.reduceRight(function(t,e){return[e*t[0]].concat(t)},[e]).slice(1)}static isContiguousSlice(t){const e=[...t.keys()].filter(function(e){return!(t[e]>=0)});if(!e.length)return!0;for(let t=0,r=1;r<e.length;t++,r++)if(e[t]+1!==e[r])return!1;return!0}static smartReshape(t,e,r){return t>0?t:this.size/-c.multiply(r)}},format:class{static formatNumber(t){return t.toPrecision(i.ND_PRINT_PRECISION).substring(0,i.ND_PRINT_PRECISION)}static likeNumpy(t){return t.map(function(t){return Array.isArray(t)?this.likeNumpy(t):this.formatNumber(t)},this)}},nd:class{static access(t,e){return t.data[t.header.offset+e.reduce(function(e,r,n){return e+r*t.header.stride[n]},0)]}static accessMany(t,e){return t.map(function(t){return typeof t===i.NUMBER?t:t.header.shape.length!==e.length?this.access(t,e.slice(-t.header.shape.length)):this.access(t,e)},this)}static*indices(t,e=[]){void 0===t[0]&&(yield e),t[0]===i.ND_SLICE_CHARACTER&&(yield*this.indices(t.slice(1),e.concat(i.ND_SLICE_CHARACTER)));for(let r=0;r<t[0];r++)yield*this.indices(t.slice(1),e.concat(r))}},raw:class{static*flatten(t){for(let e=0;e<t.length;e++)Array.isArray(t[e])?yield*this.flatten(t[e]):yield t[e]}static createRawArray(t,e=function(){return 0}){return t.length?new Array(t[0]).fill(null).map(function(){return this.createRawArray(t.slice(1),e)},this):e()}static cycle(t,e){const r=[...t];return r.splice(-e%r.length).concat(r)}static getShape(t,e=[]){return t.length?this.getShape(t[0],e.concat(t.length)):e}},type:s}};class o{constructor(t){this.shape=t.shape,this.size=c.multiply(this.shape),this.stride=void 0!==t.stride?t.stride:a.array.header.getStride(this.shape),this.offset=void 0!==t.offset?t.offset:0,this.contig=void 0===t.contig||t.contig}copy(){return new o(JSON.parse(JSON.stringify(this)))}sliceByAxis(t){return t.sort(n.subtract),this.shape.map(function(e,r){return t[0]!==r?":":(t.shift(),e)})}slice(t){const e=this.copy();e.contig=a.array.header.isContiguousSlice(t);for(let r=0,n=0;r<this.shape.length;r++)t[r]>=0&&(e.offset+=this.stride[r]*t[r],e.stride.splice(r-n,1),e.shape.splice(r-n,1),n++);return e.size=c.multiply(e.shape),e}reshape(t){const e=this.copy(),r=e.stride.slice(-1).pop();return e.shape=t.map(a.array.header.smartReshape.bind(this)),e.stride=a.array.header.getStride(e.shape,r),e}transpose(){const t=this.copy();return t.stride.reverse(),t.shape.reverse(),t.contig=!1,t}}class c{static add(t){return t.reduce(n.add)}static multiply(t){return t.reduce(n.multiply,1)}static divide(t){return t.reduce(n.divide)}static subtract(t){return t.reduce(n.subtract)}static min(t){return t.reduce(n.min)}static max(t){return t.reduce(n.max)}static square(t){return t.map(n.square)}static mean(t){return c.add(t)/t.length}static norm(t){return Math.sqrt(c.add(c.square(t)))}static elementwise(t,e){const r=a.array.type.compareManyTypes(e),n=new r(e[0].data.length),i=new o({shape:e[0].header.shape});let s=0;for(const r of a.array.nd.indices(i.shape))n[s++]=t(a.array.nd.accessMany(e,r));return[n,i,r]}}class u{static multiply(t,e){const r=a.array.type.compareTypes(t.type,e.type),n=new o({shape:[t.header.shape[0],e.header.shape[1]]}),i=new r(t.header.shape[0]*e.header.shape[1]);for(let r=0,s=0;r<n.shape[0];r++)for(let o=0;o<n.shape[1];o++,s++)for(let n=0;n<t.header.shape[1];n++)i[s]+=a.array.nd.access(t,[r,n])*a.array.nd.access(e,[n,o]);return[i,n,r]}}var l=r(0);class h{c1(t,e="float64"){const r=a.array.raw.flatten(t),n=a.array.raw.getShape(t);return this.type=a.array.type.TYPE_MAP[e],this.data=new this.type(r),this.header=new o({shape:n}),this}c2(t,e,r){return this.data=t,this.header=e,this.type=r,this.header.shape.length?this:this.data[this.header.offset]}static array(t,e="float64"){return(new h).c1(t,e)}static zeros(...t){return(new h).c1(a.array.raw.createRawArray(t))}static arange(...t){return 1===t.length?(new h).c1([...a.math.getIntegerRange(0,t[0],1)]):2===t.length?(new h).c1([...a.math.getIntegerRange(t[0],t[1],1)]):3===t.length?(new h).c1([...a.math.getIntegerRange(t[0],t[1],t[2])]):void 0}static dot(...t){return t.reduce(function(t,e){return t.dot(e)})}dot(t){return(new h).c2(...u.multiply(this,t))}axisFn(t,e){return t.length?(new h).c2(...c.elementwise(e,[...this.sliceByAxis(t)])):e(this.data)}elementFn(t,e){return(new h).c2(...c.elementwise(e,[this,t]))}min(...t){return this.axisFn(t,c.min)}max(...t){return this.axisFn(t,c.max)}mean(...t){return this.axisFn(t,c.mean)}norm(...t){return this.axisFn(t,c.norm)}add(t){return this.elementFn(t,c.add)}subtract(t){return this.elementFn(t,c.subtract)}multiply(t){return this.elementFn(t,c.multiply)}divide(t){return this.elementFn(t,c.divide)}*sliceByAxis(t=[0]){for(const e of a.array.nd.indices(this.header.sliceByAxis(t)))yield this.slice(...e)}slice(...t){return(new h).c2(this.data,this.header.slice(t),this.type)}T(){return(new h).c2(this.data,this.header.transpose(),this.type)}reshape(...t){return this.header.contig?(new h).c2(this.data,this.header.reshape(t),this.type):(new h).c2(new this.type(this.toRawFlat()),new o({shape:t}),this.type)}toRawArray(){return[...this.sliceByAxis()].map(function(t){return t instanceof h?t.toRawArray():t})}toRawFlat(){return[...this.sliceByAxis(...this.header.shape.keys())]}toString(){return a.array.format.likeNumpy(this.toRawArray())}[l.inspect.custom](){return this.toString()}}h.random=class{static randint(t,e,r){return(new h).c1(a.array.raw.createRawArray(r,function(){return class{static randInt(t,e){return Math.floor(t+Math.random()*e)}}.randInt(t,e)}))}};var p=[class{constructor(t){this.media=t}createBitmap(){const[t,e]=this.media.header.shape;return createImageBitmap(new ImageData(this.media.data,e,t))}async render(t,e,r){const n=e.origin.slice(0),i=e.origin.slice(1);t.context.drawImage(await this.createBitmap(),n,i)}static matches(t){return t.data instanceof Uint8ClampedArray}},class{constructor(t){this.media=t}async render(t,e,r){const n=this.media.mean(0,1),i=e.transform(-n.slice(0),-n.slice(1),-n.slice(2)),s=e.rotate(Math.PI/6),a=this.media.norm(2).max(),o=e.scale(e.size.X/a,e.size.Y/a,e.size.Z/a),c=e.transform(e.origin.X,e.origin.Y,0),u=h.dot(i,s,o,c),l=this.media.reshape(-1,4),p=l.dot(u);for(let e=0;e<l.header.shape[0];e++){const[r,n,i,s]=p.slice(e).toRawArray(),[a,o,c,u]=l.slice(e).toRawArray();t.context.fillStyle=`rgb(${a}, ${o}, ${c})`,t.context.fillRect(r,n,1,1)}}static matches(t){return t.data instanceof Float64Array}}];class d{static getMediaSource(t){for(const e of p)if(e.matches(t))return new e(t);return t}}class f{constructor(t){this.origin=t.origin,this.size=t.size}transform(t,e,r){return h.array([[1,0,0,0],[0,1,0,0],[0,0,1,0],[t,e,r,1]])}scale(t,e,r){return h.array([[t,0,0,0],[0,e,0,0],[0,0,r,0],[0,0,0,1]])}rotate(t){const e=Math.cos(t),r=Math.sin(t);return h.array([[e,0,r,0],[0,1,0,0],[-r,0,e,0],[0,0,0,1]])}}class y{constructor(t){this.display=t,this.getExecutorAndBind=this.getExecutorAndBind.bind(this)}getExecutorAndBind(t){return function(e,r){setTimeout(e,this.display.animationPause,t)}}step(t){return new Promise(this.getExecutorAndBind(t))}}class g{static parseSocketMessage(t){const e=JSON.parse(t);return[e.rawArray,e.arrayType]}}class m{constructor(t){this.source=d.getMediaSource(t.data),this.layoutManager=new f(t.layout),this.playbackManager=new y(t.playback)}render(t){this.source.render(t,this.layoutManager,this.playbackManager)}static createFromSocketMessage(t){const[e,r]=g.parseSocketMessage(t.data);return new m({data:h.array(e,r),layout:{origin:{X:400,Y:400},size:{X:888,Y:888,Z:888}},playback:{animate:!0,repeat:!1,alive:!0,animationPause:0}})}}new class{constructor(t){this.scene=t.scene,this.socket=t.socket,this.socket.listen("message",this.addPodFromSocketMessage.bind(this)),window.setInterval(this.render.bind(this))}addPodFromSocketMessage(t){this.scene.pods.push(m.createFromSocketMessage(t))}render(){this.scene.render()}}({scene:new class{constructor(t){this.canvas=t.canvas||document.getElementById("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.addEventListener("mousedown",console.log),this.canvas.addEventListener("mouseup",console.log),this.canvas.addEventListener("mousemove",console.log),this.width=this.canvas.clientWidth,this.height=this.canvas.clientHeight,this.pods=t.pods||[]}render(){}}({canvas:document.getElementById("canvas")}),socket:new class{constructor(t){this.port=t.port||3e3,this.host=t.host||"localhost",this.socket=new WebSocket(`ws://${this.host}:${this.port}/`)}listen(t,e){this.socket.addEventListener(t,e)}}({port:3e3,host:"localhost"})})}]);